---
permalink: maintenance-e2800/controllers-simplex-supertask-task.html 
sidebar: sidebar 
keywords: replace E2800 controller, replacing E2800 controller, simplex controller replacement, E2800, E-Series, eseries 
summary: シンプレックス構成では、障害が発生したコントローラキャニスターを交換することができます。 
---
= E2800 シンプレックス構成でのコントローラの交換
:allow-uri-read: 
:experimental: 
:icons: font
:imagesdir: ../media/


[role="lead"]
次のコントローラシェルフでは、シンプレックス（シングルコントローラ）構成の障害が発生したコントローラキャニスターを交換することができます。

* E2812 コントローラシェルフ
* E2824 コントローラシェルフ
* EF280 フラッシュアレイ


コントローラキャニスターには、コントローラカード、バッテリ、およびオプションでホストインターフェイスカード（ HIC ）が搭載されています。障害が発生したコントローラキャニスターを交換するときは、バッテリと HIC が取り付けられている場合は元のコントローラキャニスターから取り外して、交換用コントローラキャニスターに取り付ける必要があります。

この 手順 環境 IOM12 および IOM12B ドライブシェルフを使用します。


NOTE: この手順 は、シェルフの IOM のホットスワップや交換に使用されます。つまり、 IOM12 モジュールを別の IOM12 モジュールに交換するか、 IOM12B モジュールを別の IOM12B モジュールに交換しなければなりません。（シェルフに IOM12 モジュールを 2 台搭載することも、 IOM12B モジュールを 2 つ使用することもできます）

.必要なもの
* 交換するコントローラキャニスターと同じパーツ番号の交換用コントローラキャニスター。
* ESD リストバンドを装着するか、静電気防止処置を施しておきます。
* コントローラキャニスターに接続する各ケーブルを識別するためのラベル。
* No.1 プラスドライバ。
* コントローラの SANtricity System Manager にアクセスできるブラウザを備えた管理ステーション。（ System Manager インターフェイスを開くには、ブラウザでコントローラのドメイン名または IP アドレスを指定します）。




== 手順 1 ：コントローラを交換する準備（シンプレックス）

コントローラキャニスターを交換する準備として、ドライブセキュリティキーを保存し、構成をバックアップし、サポートデータを収集します。そのあと、ホスト I/O 処理を停止し、コントローラシェルフの電源をオフにすることができます。

.手順
. 可能であれば、コントローラに現在インストールされている SANtricity OS ソフトウェアのバージョンをメモしておいてください。SANtricity System Manager を開いて、次のメニューを選択します。サポート [Upgrade Center] > [View Software and Firmware Inventory]
. ドライブセキュリティ機能が有効になっている場合は、保存されたキーが存在すること、およびそのインストールに必要なパスフレーズを確認しておきます。
+

CAUTION: * データアクセスが失われる可能性 * -- ストレージアレイのすべてのドライブでセキュリティが有効になっている場合、 SANtricity ストレージマネージャのエンタープライズ管理ウィンドウを使用してセキュリティ保護されたドライブのロックを解除するまで、新しいコントローラはストレージアレイにアクセスできません。

+
キーを保存する手順は次のとおりです（コントローラの状態によっては実行できない場合があります）。

+
.. SANtricity システムマネージャで、 [MENU: Settings （メニュー：設定） ] [System] （システム）を選択します。
.. ドライブセキュリティキー管理 * で、 * バックアップキー * を選択します。
.. [ * パスフレーズを定義 / パスフレーズを再入力 * ] フィールドに、このバックアップコピーのパスフレーズを入力して確認します。
.. [ バックアップ ] をクリックします。
.. 安全な場所にキー情報を記録し、 [*Close*] をクリックします。


. SANtricity システムマネージャを使用して、ストレージアレイの構成データベースをバックアップします。
+
コントローラを取り外すときに問題が発生した場合は、保存したファイルを使用して構成をリストアできます。RAID 構成データベースの現在の状態が保存されます。これには、コントローラ上のボリュームグループとディスクプールのすべてのデータが含まれます。

+
** System Manager から：
+
... メニューを選択します。 Support [ Support Center > Diagnostics ] （サポートセンター > 診断）。
... [ 構成データの収集 *] を選択します。
... [*Collect*]( 収集 ) をクリックします
+
ブラウザの Downloads フォルダに、「 * configurationdata-<ArrayName>-<dateTime >.7z * 」という名前でファイルが保存されます。



** または、次の CLI コマンドを使用して構成データベースをバックアップすることもできます。
+
'ave storageArray dbmDatabase sourceLocation=onboard contentType=all file="filename";`



. SANtricity システムマネージャを使用してストレージアレイのサポートデータを収集します。
+
コントローラの取り外し時に問題が発生した場合は、保存したファイルを使用して問題のトラブルシューティングを行うことができます。ストレージアレイに関するインベントリ、ステータス、およびパフォーマンスデータが 1 つのファイルに保存されます。

+
.. メニューを選択します。 Support [ Support Center > Diagnostics ] （サポートセンター > 診断）。
.. 「サポートデータの収集」を選択します。
.. [*Collect*]( 収集 ) をクリックします
+
ブラウザの Downloads フォルダに、「 * support-data.7z * 」という名前でファイルが保存されます。



. ストレージアレイと接続されているすべてのホストの間で I/O 処理が発生しないようにします。たとえば、次の手順を実行します。
+
** ストレージからホストにマッピングされた LUN に関連するすべてのプロセスを停止します。
** ストレージからホストにマッピングされた LUN にアプリケーションがデータを書き込んでいないことを確認します。
** アレイのボリュームに関連付けられているファイルシステムをすべてアンマウントします。
+

NOTE: ホスト I/O 処理を停止する具体的な手順はホストオペレーティングシステムや構成によって異なり、ここでは説明していません。環境内でホスト I/O 処理を停止する方法がわからない場合は、ホストをシャットダウンすることを検討してください。

+

CAUTION: * データ損失の可能性 * - I/O 処理の実行中にこの手順を続行すると、データが失われる可能性があります。



. キャッシュメモリ内のデータがドライブに書き込まれるまで待ちます。
+
キャッシュされたデータをドライブに書き込む必要がある場合は、コントローラの背面にある緑のキャッシュアクティブ LED が点灯します。この LED が消灯するまで待つ必要があります。

. SANtricity システムマネージャのホームページで、「 * 進行中の処理を表示」を選択します。
. すべての処理が完了したことを確認してから、次の手順に進みます。
. コントローラシェルフの両方の電源スイッチをオフにします。
. コントローラシェルフのすべての LED が消灯するまで待ちます。
. Recovery Guru で「 * 再確認」を選択し、「詳細」領域の「 * 削除してもよろしいですか * 」フィールドに「はい」と表示されていることを確認します。これは、このコンポーネントを削除しても安全であることを示します。
+
コントローラキャニスターを交換するまで、ストレージアレイのデータにはアクセスできません。





== 手順 2 ：障害が発生したコントローラを取り外す（シンプレックス）

障害が発生したキャニスターを新しいキャニスターに交換します。



=== 手順 2a ：コントローラキャニスターを取り外す（シンプレックス）

コントローラキャニスターを取り外します。

.手順
. ESD リストバンドを装着するか、静電気防止処置を施します。
. コントローラキャニスターに接続された各ケーブルにラベルを付けます。
. コントローラキャニスターからすべてのケーブルを外します。
+

CAUTION: パフォーマンスの低下を防ぐために、ケーブルをねじったり、折り曲げたり、はさんだり、踏みつけたりしないでください。

. コントローラキャニスターの HIC ポートで SFP+ トランシーバを使用している場合は、 SFP を取り外します。
+
障害が発生したコントローラキャニスターから HIC を取り外す必要があるため、 HIC ポートから SFP をすべて取り外す必要があります。ただし、ベースボードホストポートに取り付けられた SFP は残しておいてかまいません。新しいコントローラのケーブル接続の準備ができたら、それらの SFP を新しいコントローラキャニスターに簡単に移すことができます。この方法は、複数のタイプの SFP を使用している場合に特に便利です。

. コントローラの背面にあるキャッシュアクティブ LED が消灯していることを確認します。
+
キャッシュされたデータをドライブに書き込む必要がある場合は、コントローラの背面にある緑のキャッシュアクティブ LED が点灯します。この LED が消灯するのを待ってから、コントローラキャニスターを取り外す必要があります。

+

NOTE: この図はコントローラキャニスターの例を示したものです。ホストポートの数やタイプは、コントローラによって異なる場合があります。

+
image::../media/28_dwg_2800_controller_attn_led_maint-e2800.gif[28 DWG 2800 controller Attn led maint e2800]

+
* （ 1 ） * _ キャッシュアクティブ LED_

. カムハンドルのラッチを外れるまで押し、カムハンドルを右側に開いてコントローラキャニスターをミッドプレーンから外します。
+
image::../media/28_dwg_e2824_remove_controller_canister_simplex_maint-e2800.gif[28 dwg e2824 ：コントローラキャニスターのシンプレックス maint e2800 の取り外し]

+
* （ 1 ） * _ コントローラキャニスター _

+
* （ 2 ） * _CAM ハンドル _

. 両手でカムハンドルをつかみ、コントローラキャニスターをスライドしてシェルフから引き出します。
+

CAUTION: コントローラキャニスターは重いので、必ず両手で支えながら作業してください。

+
コントローラキャニスターを取り外すと、可動式のふたが所定の位置に戻って、通期と冷却が維持されます。

. 取り外し可能なカバーが上になるようにコントローラキャニスターを裏返します。
. コントローラキャニスターを静電気防止処置を施した平らな場所に置きます。




=== 手順 2b ：バッテリを取り外す（シンプレックス）

コントローラキャニスターをコントローラシェルフから取り外したあと、バッテリを取り外します。

.手順
. コントローラキャニスターのカバーをボタンを押し下げながらスライドして取り外します。
. コントローラ内部（バッテリと DIMM の間）の緑の LED が消灯していることを確認します。
+
この緑の LED が点灯している場合は、コントローラがまだバッテリ電源を使用しています。この LED が消灯するのを待ってから、コンポーネントを取り外す必要があります。

+
image::../media/28_dwg_e2800_internal_cache_active_led_maint-e2800.gif[28 dwg e2800 内部キャッシュアクティブ LED maint e2800]

+
* （ 1 ） * _ 内部キャッシュアクティブ _

+
* （ 2 ） * _ バッテリ _

. バッテリの青色のリリースラッチの位置を確認します。
. バッテリをリリースラッチを押し下げながら引き出し、コントローラキャニスターから外します。
+
image::../media/28_dwg_e2800_remove_battery_maint-e2800.gif[28 dwg e2800 バッテリメンテナンス e2800 を取り外します]

+
* （ 1 ） * _ バッテリリリースラッチ _

+
* （ 2 ） * _ バッテリ _

. バッテリを持ち上げながらスライドし、コントローラキャニスターから引き出します。




=== 手順 2c ：ホストインターフェイスカードの取り外し（シンプレックス）

コントローラキャニスターにホストインターフェイスカード（ HIC ）が搭載されている場合は、新しいコントローラキャニスターで再利用できるように元のコントローラキャニスターから HIC を取り外します。

.手順
. コントローラキャニスターに HIC カバーを固定しているネジを No.1 プラスドライバを使用して外します。
+
ネジは 4 本あります。 1 本は上部に、もう 1 本は側面に、 2 本は前面にあります。

+
image::../media/28_dwg_e2800_hic_faceplace_screws_maint-e2800.gif[28 DWG e2800 HIC の前面取り付けネジ maint e2800]

. HIC カバーを取り外します。
. コントローラカードに HIC を固定している 3 本の取り付けネジを手またはプラスドライバで緩めます。
. HIC を持ち上げながら後方にスライドし、コントローラカードから慎重に外します。
+

CAUTION: HIC の底面やコントローラカードの表面のコンポーネントをこすったりぶつけたりしないように注意してください。

+
image::../media/28_dwg_e2800_hic_thumbscrews_maint-e2800.gif[28 dwg e2800 HIC 蝶ネジ maint e2800]

+
* （ 1 ） * _ ホスト・インターフェイス・カード _

+
* （ 2 ） * _ 蝶ねじ _

. HIC を静電気防止処置を施した場所に置きます。




== 手順 3 ：新しいコントローラを取り付ける（シンプレックス）

障害が発生したコントローラキャニスターの代わりに、新しいコントローラキャニスターを取り付けます。



=== 手順 3a ：バッテリを取り付ける（シンプレックス）

交換用コントローラキャニスターにバッテリを取り付けます。元のコントローラキャニスターから取り外したバッテリを取り付けるか、新しいバッテリを注文して取り付けることができます。

.手順
. 交換用コントローラキャニスターを開封し、取り外し可能なカバーを上にして、静電気防止処置を施した平らな場所に置きます。
+
梱包材は、障害が発生したコントローラキャニスターを発送するときのために保管しておいてください。

. カバーのボタンを押し下げながらスライドし、カバーを取り外します。
. バッテリのスロットが手前になるようにコントローラキャニスターの向きを変えます。
. バッテリを少し下に傾けながらコントローラキャニスターに挿入します。
+
バッテリ前部の金属製のフランジをコントローラキャニスター下部のスロットに挿入し、バッテリの上部がキャニスターの左側にある小さな位置決めピンの下にくるまでスライドする必要があります。

. バッテリラッチを上に動かしてバッテリを固定します。
+
カチッという音がしてラッチが固定されると、ラッチの下部がシャーシの金属製のスロットに収まります。

+
image::../media/28_dwg_e2800_insert_battery_maint-e2800.gif[28 DWG e2800 INSERT BATTERY maint e2800]

+
* （ 1 ） * _ バッテリリリースラッチ _

+
* （ 2 ） * _ バッテリ _

. コントローラキャニスターを裏返し、バッテリが正しく取り付けられていることを確認します。
+

CAUTION: * ハードウェアの破損の可能性 * - バッテリ前部の金属製のフランジがコントローラキャニスターのスロットにしっかりと挿入されている必要があります（ 1 つ目の図）。バッテリが正しく取り付けられていないと（ 2 つ目の図）、金属製のフランジがコントローラボードに接触し、電源を投入したときにコントローラの破損の原因となる可能性があります。

+
** * 正解 * - バッテリの金属製のフランジがコントローラのスロットにしっかりと挿入されています。
+
image:../media/28_dwg_e2800_battery_flange_ok_maint-e2800.gif[""]

** * 不正解 * - バッテリの金属製のフランジがコントローラのスロットに挿入されていません：
+
image:../media/28_dwg_e2800_battery_flange_not_ok_maint-e2800.gif[""]







=== 手順 3b ：ホストインターフェイスカードの取り付け（シンプレックス）

元のコントローラキャニスターからホストインターフェイスカード（ HIC ）を取り外した場合、その HIC を新しいコントローラキャニスターに取り付けます。

.手順
. 交換用コントローラキャニスターにブランクカバーを固定している 4 本のネジを No.1 プラスドライバを使用して外し、カバーを取り外します。
. HIC の 3 本の取り付けネジをコントローラの対応する穴に合わせ、 HIC の底面のコネクタをコントローラカードの HIC インターフェイスコネクタに合わせます。
+
HIC の底面やコントローラカードの表面のコンポーネントをこすったりぶつけたりしないように注意してください。

. HIC を所定の位置に慎重に置き、 HIC をそっと押して HIC コネクタを固定します。
+

CAUTION: * 機器の破損の可能性 * -- HIC と取り付けネジの間にあるコントローラ LED の金色のリボンコネクタをはさまないように十分に注意してください。

+
image::../media/28_dwg_e2800_hic_thumbscrews_maint-e2800.gif[28 dwg e2800 HIC 蝶ネジ maint e2800]

+
* （ 1 ） * _ ホスト・インターフェイス・カード _

+
* （ 2 ） * _ 蝶ねじ _

. HIC の取り付けネジを手で締めます。
+
ネジを締め付けすぎる可能性があるため、ドライバは使用しないでください。

. 元のコントローラキャニスターから取り外した HIC カバーを新しいコントローラキャニスターに取り付け、 No.1 プラスドライバを使用して 4 本のネジで固定します。
+
image::../media/28_dwg_e2800_hic_faceplace_screws_maint-e2800.gif[28 DWG e2800 HIC の前面取り付けネジ maint e2800]





=== 手順 3c ：新しいコントローラキャニスターを取り付ける（シンプレックス）

バッテリを取り付け、もともと取り付けられていた場合は HIC も取り付けると、新しいコントローラキャニスターをコントローラシェルフに取り付けることができるようになります。

.手順
. カチッという音がしてボタンが固定されるまでカバーを前方から後方にスライドして、コントローラキャニスターにカバーを再度取り付けます。
. 取り外し可能なカバーが下になるようにコントローラキャニスターを裏返します。
. カムハンドルを開いた状態でコントローラキャニスターをスライドし、コントローラシェルフに最後まで挿入します。
+
image::../media/28_dwg_e2824_remove_controller_canister_simplex_maint-e2800.gif[28 dwg e2824 ：コントローラキャニスターのシンプレックス maint e2800 の取り外し]

+
* （ 1 ） * _ コントローラキャニスター _

+
* （ 2 ） * _CAM ハンドル _

. カムハンドルを左側に動かして、コントローラキャニスターを所定の位置にロックします。
. 元のコントローラから取り外した SFP を新しいコントローラのホストポートに取り付け、すべてのケーブルを再接続します。
+
ホストプロトコルを複数使用している場合は、 SFP を取り付けるホストポートを間違えないように注意してください。

. 交換用コントローラに IP アドレスを割り当てる方法を決めます。この方法は、ネットワークへのイーサネットポート 1 （ P1 というラベルが付いたポート）の接続に DHCP サーバが使用されているかどうかと、すべてのドライブでセキュリティが有効になっているかどうかによって異なります。
+
|===
| DHCP サーバを使用 | すべてのドライブでセキュリティが有効 | 手順 


 a| 
はい。
 a| 
いいえ
 a| 
新しいコントローラの IP アドレスが DHCP サーバから取得されます。この値は、元のコントローラの IP アドレスと異なる場合があります。交換用コントローラの背面のラベルに記載された MAC アドレスを確認し、その情報をネットワーク管理者に伝えて、 DHCP サーバから割り当てられた IP アドレスを取得します。



 a| 
はい。
 a| 
はい。
 a| 
新しいコントローラの IP アドレスが DHCP サーバから取得されます。この値は、元のコントローラの IP アドレスと異なる場合があります。交換用コントローラの背面のラベルに記載された MAC アドレスを確認し、その情報をネットワーク管理者に伝えて、 DHCP サーバから割り当てられた IP アドレスを取得します。その後、コマンドラインインターフェイスを使用してドライブのロックを解除できます。



 a| 
いいえ
 a| 
いいえ
 a| 
取り外したコントローラの IP アドレスが新しいコントローラで使用されます。



 a| 
いいえ
 a| 
はい。
 a| 
新しいコントローラの IP アドレスを手動で設定する必要があります。（古いコントローラの IP アドレスを再利用することも、新しい IP アドレスを使用することもできます）。 コントローラの IP アドレスを確認したら、コマンドラインインターフェイスを使用してドライブのロックを解除できます。ドライブのロックが解除されると、元のコントローラの IP アドレスが新しいコントローラで自動的に再利用されます。

|===




== 手順 4 ：コントローラの交換後の処理（シンプレックス）

コントローラシェルフの電源をオンにし、サポートデータを収集して、運用を再開します。

.手順
. コントローラシェルフの背面にある 2 つの電源スイッチをオンにします。
+
** 電源投入プロセスの実行中は電源スイッチをオフにしないでください。通常、このプロセスは 90 秒以内に完了します。
** 各シェルフのファンは起動時に大きな音を立てます。起動時に大きな音がしても問題はありません。


. コントローラのブート時に、コントローラの LED とデジタル表示ディスプレイを確認します。
+
** デジタル表示ディスプレイの表示が、 * OS * 、 * SD * 、 * _blank_ * の順に切り替わり、コントローラで一日の最初の処理（ SOD ）を実行中であることが示されます。コントローラのブートが完了すると、デジタル表示ディスプレイにトレイ ID が表示されます。
** コントローラの黄色の警告 LED が点灯したあと、エラーがなければ消灯します。
** 緑色のホストリンク LED が点灯します。
+

NOTE: この図はコントローラキャニスターの例を示したものです。ホストポートの数やタイプは、コントローラによって異なる場合があります。

+
image::../media/28_dwg_attn_led_7s_display_maint-e2800.gif[28 DWG Attn が 7 s を表示し、 maint e2800 を表示した]

+
* （ 1 ） * _Attention LED （アンバー） _

+
* （ 2 ） * _デジタル 表示ディスプレイ _

+
* （ 3 ） * _ ホストリンク LED _



. コントローラシェルフのいずれかの警告 LED が点灯している場合は、コントローラキャニスターが正しく取り付けられ、すべてのケーブルが正しく装着されていることを確認します。必要に応じて、コントローラキャニスターを再度取り付けます。
+

NOTE: 問題が解決しない場合は、テクニカルサポートにお問い合わせください。

. ストレージアレイにセキュアドライブがある場合は、ドライブセキュリティキーをインポートします。それ以外の場合は、次の手順に進みます。すべてのセキュアドライブを含むストレージアレイ、またはセキュアドライブとセキュアでないドライブが混在しているストレージアレイの場合は、以下の該当する手順に従います。
+

NOTE: セキュアでないドライブ _ 未割り当てのドライブ、グローバルホットスペアドライブ、またはドライブセキュリティ機能で保護されていないボリュームグループまたはプールに含まれるドライブです。_Secure drives _ は、ドライブセキュリティを使用して保護されたボリュームグループまたはディスクプールに属する割り当て済みのドライブです。

+
** * セキュリティ保護されたドライブのみ ( セキュリティ保護されていないドライブは不要 )* ：
+
... ストレージアレイのコマンドラインインターフェイス（ CLI ）にアクセスします。
... 次のコマンドを入力して、セキュリティキーをインポートします。
+
[listing]
----
import storageArray securityKey file="C:/file.slk"
passPhrase="passPhrase";
----
+
ここで、

+
**** 「 C:\file.slk 」は、ドライブセキュリティキーのディレクトリの場所と名前を表します
**** 「 passphrase 」は、セキュリティキーをインポートし、コントローラを再起動し、新しいコントローラがストレージアレイの保存された設定を採用した後、ファイルのロックを解除するために必要なパスフレーズです。


... 次の手順に進み、新しいコントローラが「最適」になっていることを確認します。


** * 安全なドライブと安全でないドライブの混在 * ：
+
... サポートバンドルを収集して、ストレージアレイプロファイルを開きます。
... セキュアでないドライブの場所をすべて検出して記録します。これらの場所はサポートバンドルに含まれています。
... システムの電源を切ります。
... セキュアでないドライブを取り外します。
... コントローラを交換してください。
... システムの電源を入れ、デジタル表示ディスプレイにトレイ番号が表示されるまで待ちます。
... SANtricity システムマネージャで、 [MENU: Settings （メニュー：設定） ] [System] （システム）を選択します。
... [ セキュリティキーの管理 ] セクションで、 [ キーの作成 / 変更 *] を選択して新しいセキュリティキーを作成します。
... 保存したセキュリティキーをインポートするには、「 Secure Drives のロック解除」を選択します。
... 「 set allDrives nativeState 」 CLI コマンドを実行します。
+
コントローラが自動的にリブートされます。

... コントローラがブートし、デジタル表示ディスプレイにトレイ番号または L5 が点滅するまで待ちます。
... システムの電源を切ります。
... セキュアでないドライブを取り付け直します。
... SANtricity システムマネージャを使用してコントローラをリセットします。
... システムの電源を入れ、デジタル表示ディスプレイにトレイ番号が表示されるまで待ちます。
... 次の手順に進み、新しいコントローラが「最適」になっていることを確認します。




. SANtricity System Manager で、新しいコントローラが「最適」になっていることを確認します。
+
.. 「 * ハードウェア * 」を選択します。
.. コントローラシェルフの場合は、 * Show back of shelf * を選択します。
.. 交換したコントローラキャニスターを選択します。
.. 「 * 表示設定 * 」を選択します。
.. コントローラの * Status * が最適な状態であることを確認します。
.. ステータスが「最適」でない場合は、コントローラを強調表示し、「オンラインにする」を選択します。


. SANtricity システムマネージャを使用してストレージアレイのサポートデータを収集します。
+
.. メニューを選択します。 Support [ Support Center （サポートセンター） ] > * Diagnostics （診断） ] 。
.. 「サポートデータの収集」を選択します。
.. [*Collect*]( 収集 ) をクリックします
+
ブラウザの Downloads フォルダに、「 * support-data.7z * 」という名前でファイルが保存されます。





これでコントローラの交換は完了です。通常の運用を再開することができます。
