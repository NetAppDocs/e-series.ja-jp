---
permalink: maintenance-ef600/hics-upgrade-intro.html 
sidebar: sidebar 
keywords: upgrade EF300 HIC, upgrade EF600 HIC, increase host ports, change host protocol 
summary: ホストインターフェイスカード（ HIC ）をアップグレードして、ホストポートの数を増やしたり、ホストプロトコルを変更したりできます。 
---
= EF300 または EF600 ホストインターフェイスカード（ HIC ）のアップグレード
:experimental: 
:icons: font
:imagesdir: ../media/


[role="lead"]
ホストインターフェイスカード（ HIC ）をアップグレードして、ホストポートの数を増やしたり、ホストプロトコルを変更したりできます。

.このタスクについて
* HIC をアップグレードするには、ストレージアレイの電源をオフにし、 HIC をアップグレードしてから再度オンにする必要があります。
* EF300 または EF600 コントローラの HIC をアップグレードする場合は、同じ手順を繰り返して 2 台目のコントローラを取り外し、 2 台目のコントローラの HIC をアップグレードし、 2 台目のコントローラを取り付けてからコントローラシェルフの電源を再度オンにします。


.作業を開始する前に
* レビュー link:hics-overview-supertask-concept.html["EF300 または EF600 の HIC をアップグレードするための要件"]。
* この手順のダウンタイムメンテナンス時間をスケジュールします。この手順が完了するまではストレージアレイのデータにアクセスできません。電源がオンになっているときは両方のコントローラで HIC の構成が同じである必要があるため、 HIC を取り付けるときは電源をオフにする必要があります。


.必要なもの
* コントローラと互換性がある HIC が 2 つ必要です。
* ESD リストバンドを装着するか、静電気防止処置を施しておきます。
* 静電気防止処置を施した平らな作業場所。
* コントローラキャニスターに接続する各ケーブルを識別するためのラベル。
* No.1 プラスドライバ。
* コントローラの SANtricity System Manager にアクセスできるブラウザを備えた管理ステーション。（ System Manager インターフェイスを開くには、ブラウザでコントローラのドメイン名または IP アドレスを指定します）。



CAUTION: * データアクセスが失われる可能性 * - 別の E シリーズコントローラ用に設計された HIC を EF300 または EF600 コントローラキャニスターに取り付けないでください。また、両方のコントローラと両方の HIC が同じでなければなりません。互換性がない HIC や一致しない HIC が取り付けられていると、コントローラに電源を投入したときにロックダウン状態になります。



== 手順 1 ：コントローラシェルフをオフラインにする

HIC を安全にアップグレードできるように、コントローラシェルフをオフラインにします。

.手順
. SANtricity System Manager のホームページで、ストレージアレイのステータスが最適であることを確認します。
+
ステータスが「最適」でない場合は、 Recovery Guru を使用するかテクニカルサポートに問い合わせて問題を解決してください。この手順を続行しないでください。

. SANtricity システムマネージャを使用して、ストレージアレイの構成データベースをバックアップします。
+
コントローラを取り外すときに問題が発生した場合は、保存したファイルを使用して構成をリストアできます。RAID 構成データベースの現在の状態が保存されます。これには、コントローラ上のボリュームグループとディスクプールのすべてのデータが含まれます。

+
** System Manager から：
+
... メニューを選択します。 Support [ Support Center > Diagnostics ] （サポートセンター > 診断）。
... [ 構成データの収集 *] を選択します。
... [*Collect*]( 収集 ) をクリックします
+
ブラウザの Downloads フォルダに、「 * configurationdata-<ArrayName>-<dateTime >.7z * 」という名前でファイルが保存されます。





. ストレージアレイと接続されているすべてのホストの間で I/O 処理が発生しないようにします。たとえば、次の手順を実行します。
+
** ストレージからホストにマッピングされた LUN に関連するすべてのプロセスを停止します。
** ストレージからホストにマッピングされた LUN にアプリケーションがデータを書き込んでいないことを確認します。
** アレイのボリュームに関連付けられているファイルシステムをすべてアンマウントします。
+

NOTE: ホスト I/O 処理を停止する具体的な手順はホストオペレーティングシステムや構成によって異なり、ここでは説明していません。環境内でホスト I/O 処理を停止する方法がわからない場合は、ホストをシャットダウンすることを検討してください。

+

CAUTION: * データ損失の可能性 * - I/O 処理の実行中にこの手順を続行すると、ストレージがアクセスできないため、ホストアプリケーションがデータにアクセスできなくなる可能性があります。



. キャッシュメモリ内のデータがドライブに書き込まれるまで待ちます。
+
キャッシュされたデータをドライブに書き込む必要がある場合は、各コントローラの背面にある緑のキャッシュアクティブ LED が点灯します。この LED が消灯するまで待つ必要があります。

. SANtricity システムマネージャのホームページで、「 * 進行中の操作を表示」を選択します。すべての処理が完了するまで待ってから、次の手順に進みます。
. コントローラシェルフの電源をオフにします。
+
.. 両方の電源ケーブルにラベルを付けてコントローラシェルフから抜きます。
.. コントローラシェルフのすべての LED が消灯するまで待ちます。






== 手順 2 ：コントローラキャニスターを取り外す

新しい HIC をアップグレードできるように、コントローラキャニスターを取り外します。

.手順
. コントローラキャニスターに接続された各ケーブルにラベルを付けます。
. コントローラキャニスターからすべてのケーブルを外します。
+

CAUTION: パフォーマンスの低下を防ぐために、ケーブルをねじったり、折り曲げたり、はさんだり、踏みつけたりしないでください。

. HIC ポートで SFP+ トランシーバを使用している場合は取り外します。
+
アップグレードする HIC のタイプによっては、それらの SFP を再利用できる場合もあります。

. コントローラの背面にあるキャッシュアクティブ LED が消灯していることを確認します。
. コントローラの両側にあるハンドルをつかみ、シェルフから外れるまで引き出します。
+
image::../media/remove_controller_5.png[コントローラ 5 を取り外します]

. 両手でハンドルをつかみ、コントローラキャニスターをスライドしてシェルフから引き出します。コントローラの前面がエンクロージャの外に出たら、両手で完全に引き出します。
+

CAUTION: コントローラキャニスターは重いので、必ず両手で支えながら作業してください。

+
image::../media/remove_controller_6.png[コントローラ 6 を取り外します]

. コントローラキャニスターを静電気防止処置を施した平らな場所に置きます。




== 手順 3 ： HIC を取り外す

アップグレードした HIC に交換できるように、元の HIC を取り外します。

.手順
. 1 本の取り付けネジを外し、ふたを持ち上げてコントローラキャニスターのカバーを取り外します。
. コントローラ内部の緑の LED が消灯していることを確認します。
+
この緑の LED が点灯している場合は、コントローラがまだバッテリ電源を使用しています。この LED が消灯するのを待ってから、コンポーネントを取り外す必要があります。

. コントローラキャニスターに HIC カバーを固定している 2 本のネジをプラスドライバで外します。
+
image::../media/hic_2.png[HIC 2]

+

NOTE: 上の図は例です。 HIC の外観は異なる場合があります。

. HIC カバーを取り外します。
. コントローラカードに HIC を固定している 1 本の取り付けネジを手またはプラスドライバで緩めます。
+
image::../media/hic_3.png[HIC 3.]

+

NOTE: HIC の上面にはネジ穴が 3 つありますが、そのうちの 1 つだけで固定されています。

+

NOTE: 上の図は例です。 HIC の外観は異なる場合があります。

. HIC をコントローラから持ち上げて取り出し、コントローラカードから慎重に外します。
+

CAUTION: HIC の底面やコントローラカードの表面のコンポーネントをこすったりぶつけたりしないように注意してください。

+
image::../media/hic_4.png[HIC 4.]

+

NOTE: 上の図は例です。 HIC の外観は異なる場合があります。

. HIC を静電気防止処置を施した平らな場所に置きます。




== 手順 4 ： HIC をアップグレードする

古い HIC を取り外したら、新しい HIC を取り付けます。


CAUTION: * データアクセスが失われる可能性 * - 別の E シリーズコントローラ用に設計された HIC を EF300 または EF600 コントローラキャニスターに取り付けないでください。また、両方のコントローラと両方の HIC が同じでなければなりません。互換性がない HIC や一致しない HIC が取り付けられていると、コントローラに電源を投入したときにロックダウン状態になります。

.手順
. 新しい HIC と新しい HIC 表面カバーを開封します。
. HIC の 1 本の取り付けネジをコントローラの対応する穴に合わせ、 HIC の底面のコネクタをコントローラカードの HIC インターフェイスコネクタに合わせます。
+
HIC の底面やコントローラカードの表面のコンポーネントをこすったりぶつけたりしないように注意してください。

+
image::../media/hic_7.png[HIC 7.]

+

NOTE: 上の図は例です。 HIC の外観は異なる場合があります。

. HIC を所定の位置に慎重に置き、 HIC をそっと押して HIC コネクタを固定します。
+

CAUTION: * 機器の破損の可能性 * -- HIC と取り付けネジの間にあるコントローラ LED の金色のリボンコネクタをはさまないように十分に注意してください。

. HIC の取り付けネジを手で締めます。
+
image::../media/hic_3.png[HIC 3.]

+

NOTE: 上の図は一例です。 HIC の外観は異なる場合があります。

+

NOTE: ネジを締め付けすぎる可能性があるため、ドライバは使用しないでください。

. No.1 プラスドライバを使用して、元の HIC から取り外した HIC カバーを 3 本のネジで固定します。




== 手順 5 ：コントローラキャニスターを再度取り付ける

HIC をアップグレードしたら、コントローラキャニスターをコントローラシェルフに再度取り付けます。

.手順
. コントローラキャニスターのカバーを下げ、取り付けネジを固定します。
. コントローラのハンドルをつかみながら、コントローラキャニスターをそっとスライドさせてコントローラシェルフの奥まで押し込みます。
+

NOTE: コントローラがシェルフに正しく取り付けられると、カチッという音がします。

+
image::../media/remove_controller_7.png[コントローラ 7 を取り外します]

. SFP を取り外した場合は、新しい HIC に SFP を取り付け、すべてのケーブルを再接続します。ホストプロトコルを複数使用している場合は、 SFP を取り付けるホストポートを間違えないように注意してください。
+
ホストプロトコルを複数使用している場合は、 SFP を取り付けるホストポートを間違えないように注意してください。





== 手順 6 ： HIC のアップグレードを完了します

コントローラをオンラインにし、サポートデータを収集し、運用を再開します。

.手順
. コントローラをオンラインにします。
+
.. 電源ケーブルを接続します。


. コントローラのブート時に、コントローラの LED を確認します。
+
** 黄色の警告 LED が点灯した状態になります。
** ホストリンク LED は、ホストインターフェイスに応じて、点灯、点滅、消灯のいずれかになります。


. コントローラがオンラインに戻ったら、ステータスが「最適」になっていることを確認し、コントローラシェルフの警告 LED を確認します。
+
ステータスが「最適」でない場合やいずれかの警告 LED が点灯している場合は、すべてのケーブルが正しく装着され、コントローラキャニスターが正しく取り付けられていることを確認します。必要に応じて、コントローラキャニスターを取り外して再度取り付けます。

+

NOTE: 問題が解決しない場合は、テクニカルサポートにお問い合わせください。

. [ メニュー ] 、 [ サポート ] 、 [ アップグレードセンター ] の順にクリックして、最新バージョンの SANtricity OS がインストールされていることを確認します。
+
必要に応じて、最新バージョンをインストールします。

. すべてのボリュームが優先所有者に戻っていることを確認します。
+
.. 選択メニュー： Storage [Volumes][ * すべてのボリューム * ] ページで、ボリュームが優先所有者に配布されていることを確認します。メニューを選択します。 [More （その他） ] [Change ownership （所有権の変更） ] （ボリューム所有者を表示
.. すべてのボリュームが優先所有者に所有されている場合は、手順 6 に進みます。
.. いずれのボリュームも戻っていない場合は、手動でボリュームを戻す必要があります。メニューに移動します。 More [redistribution volumes （ボリュームの再配置） ] 。
.. 自動配信または手動配信のあとに一部のボリュームだけが優先所有者に戻った場合は、 Recovery Guru でホスト接続の問題を確認する必要があります。
.. Recovery Guru がない場合、または Recovery Guru の手順に従ってもボリュームが優先所有者に戻らない場合は、サポートに問い合わせてください。


. SANtricity システムマネージャを使用してストレージアレイのサポートデータを収集します。
+
.. メニューを選択します。 Support [ Support Center > Diagnostics ] （サポートセンター > 診断）。
.. 「サポートデータの収集」を選択します。
.. [*Collect*]( 収集 ) をクリックします
+
ブラウザの Downloads フォルダに、「 * support-data.7z * 」という名前でファイルが保存されます。





これでストレージアレイのホストインターフェイスカードをアップグレードする処理は完了です。通常の運用を再開することができます。
