---
permalink: maintenance-e4000/replace-hic-upgrade-e4000.html 
sidebar: sidebar 
keywords:  
summary:  
---
= E4000でのHICのアップグレード
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
ホストインターフェイスカード（HIC）をアップグレードして、ホストポートの数を増やしたり、ホストプロトコルを変更したりできます。

.このタスクについて
* HIC をアップグレードするには、ストレージアレイの電源をオフにし、 HIC をアップグレードしてから再度オンにする必要があります。
* E4000コントローラのHICをアップグレードする場合は、同じ手順を繰り返して2台目のコントローラを取り外し、2台目のコントローラのHICをアップグレードし、2台目のコントローラを再度取り付けてからコントローラシェルフの電源を再投入します。


.作業を開始する前に
* この手順のダウンタイムメンテナンス時間をスケジュールします。この手順が完了するまでは、ストレージアレイのデータにアクセスできません。電源がオンになっているときは両方のコントローラでHICの構成が同じである必要があるため、HICの構成を変更するときは電源をオフにする必要があります。HICが一致していないと、交換用HICを搭載したコントローラをオンラインにしたときにロックダウン状態になります。
* 次のものがあることを確認します。
+
** コントローラと互換性がある HIC が 2 つ必要です。
** ESD リストバンドを装着するか、静電気防止処置を施しておきます。
** 静電気防止処置を施した平らな作業場所。
** コントローラキャニスターに接続する各ケーブルを識別するためのラベル。
** No.1 プラスドライバ。
** コントローラの SANtricity System Manager にアクセスできるブラウザを備えた管理ステーション。（ System Manager インターフェイスを開くには、ブラウザでコントローラのドメイン名または IP アドレスを指定します）。
+

CAUTION: * データアクセスが失われる可能性 * - 別の E シリーズコントローラ用に設計された HIC を E4000 コントローラキャニスターに取り付けないでください。また、両方のコントローラと両方のHICが同一である必要があります。互換性がないHICや一致しないHICがあると、コントローラに電源を投入したときにロックダウン状態になります。







== 手順 1 ：コントローラシェルフをオフラインにする

HIC を安全にアップグレードできるように、コントローラシェルフをオフラインにします。

.手順
. SANtricity System Manager のホームページで、ストレージアレイのステータスが最適であることを確認します。
+
ステータスが「最適」でない場合は、 Recovery Guru を使用するかテクニカルサポートに問い合わせて問題を解決してください。この手順を続行しないでください。

. [サポート]>[アップグレードセンター]*をクリックして、最新バージョンのSANtricity OSがインストールされていることを確認します。
+
必要に応じて、最新バージョンをインストールします。

. SANtricity システムマネージャを使用して、ストレージアレイの構成データベースをバックアップします。
+
コントローラを取り外すときに問題が発生した場合は、保存したファイルを使用して構成をリストアできます。RAID 構成データベースの現在の状態が保存されます。これには、コントローラ上のボリュームグループとディスクプールのすべてのデータが含まれます。

+
** System Manager から：
+
... [サポート]>[サポートセンター]>[診断]*を選択します。
... [ 構成データの収集 *] を選択します。
... [*Collect*]( 収集 ) をクリックします
+
ブラウザの Downloads フォルダに、「 * configurationdata-<ArrayName>-<dateTime >.7z * 」という名前でファイルが保存されます。





. ストレージアレイと接続されているすべてのホストの間で I/O 処理が発生しないようにします。たとえば、次の手順を実行します。
+
** ストレージからホストにマッピングされた LUN に関連するすべてのプロセスを停止します。
** ストレージからホストにマッピングされた LUN にアプリケーションがデータを書き込んでいないことを確認します。
** アレイのボリュームに関連付けられているファイルシステムをすべてアンマウントします。
+

NOTE: ホスト I/O 処理を停止する具体的な手順はホストオペレーティングシステムや構成によって異なり、ここでは説明していません。環境内でホスト I/O 処理を停止する方法がわからない場合は、ホストをシャットダウンすることを検討してください。

+

CAUTION: * データ損失の可能性 * - I/O 処理の実行中にこの手順を続行すると、ストレージがアクセスできないため、ホストアプリケーションがデータにアクセスできなくなる可能性があります。



. キャッシュメモリ内のデータがドライブに書き込まれるまで待ちます。
+
キャッシュされたデータをドライブに書き込む必要がある場合は、各コントローラの背面にある緑のキャッシュアクティブ LED が点灯します。この LED が消灯するまで待つ必要があります。

. SANtricity システムマネージャのホームページで、「 * 進行中の操作を表示」を選択します。すべての処理が完了するまで待ってから、次の手順に進みます。
. コントローラシェルフの電源をオフにします。
+
.. 両方の電源ケーブルにラベルを付けてコントローラシェルフから抜きます。
.. コントローラシェルフのすべての LED が消灯するまで待ちます。






== 手順 2 ：コントローラキャニスターを取り外す

コントローラキャニスターをシステムから取り外し、コントローラキャニスターカバーを取り外します。

.手順
. まだ接地していない場合は、自分で適切に接地してください。
. ケーブルマネジメントデバイスに接続しているケーブルをまとめているフックとループストラップを緩め、システムケーブルとSFPをコントローラキャニスターから外し（必要な場合）、どのケーブルがどこに接続されていたかを記録します。
+
ケーブルはケーブルマネジメントデバイスに入れたままにしておきます。これは、ケーブルマネジメントデバイスを取り付け直すときにケーブルが整理されるようにするためです。

. ケーブルマネジメントデバイスをコントローラキャニスターの左右から取り外し、脇に置きます。
. カムハンドルのラッチを外れるまで押し、カムハンドルをいっぱいまで開いてコントローラキャニスターをミッドプレーンから外し、両手でコントローラキャニスターをシャーシから引き出します。
. コントローラキャニスターを裏返し、平らで安定した場所に置きます。
. コントローラキャニスターの側面にある青いボタンを押してカバーを開き、カバーを上に回転させてコントローラキャニスターから取り外します。
+
image::../media/drw_E4000_open_controller_module_cover_IEOPS-870.png[コントローラキャニスターのカバーを開きます。]





== 手順 3 ： HIC をアップグレードする

HICを取り外して交換します。

.手順
. まだ接地していない場合は、自分で適切に接地してください。
. HICを取り外します。
+
image::../media/drw_E4000_replace_HIC_source_IEOPS-864.png[コントローラモジュールからHICを取り外します。]

+
.. すべてのネジを緩め、コントローラモジュールからまっすぐにスライドしてHICカバーを取り外します。
.. HICの取り付けネジを緩め、HICを真上に持ち上げます。


. HICを再度取り付けます。
+
.. 交換用HICプラグのソケットをマザーボードのソケットに合わせ、カードをソケットに対して垂直にそっと装着します。
.. HICの3本の取り付けネジを締めます。
.. HICカバーを再度取り付けます。


. コントローラモジュールのカバーを再度取り付け、所定の位置にロックします。




== 手順 4 ：コントローラキャニスターを再度取り付ける

コントローラキャニスターをシャーシに再度取り付けます。

.手順
. まだ接地していない場合は、自分で適切に接地してください。
. コントローラキャニスターのカバーを取り付けます（まだ取り付けていない場合）。
. コントローラキャニスターを裏返し、端をシャーシの開口部に合わせます。
. コントローラキャニスターの端をシャーシの開口部に合わせ、コントローラキャニスターをシステムの半分までそっと押し込みます。
+

NOTE: 指示があるまでコントローラキャニスターをシャーシに完全に挿入しないでください。

. 必要に応じてシステムにケーブルを再接続します。
+
光ファイバケーブルを使用する場合は、メディアコンバータ（QSFPまたはSFP）を取り外したあとに再度取り付けてください。

. コントローラキャニスターの再取り付けが完了します。
+
.. カムハンドルを開いた状態で、コントローラキャニスターをミッドプレーンまでしっかりと押し込んで完全に装着し、カムハンドルをロック位置まで閉じます。
+

NOTE: コネクタの破損を防ぐため、コントローラキャニスターをスライドしてシャーシに挿入する際に力を入れすぎないように注意してください。

.. ケーブルマネジメントデバイスを再度取り付けます（まだ取り付けていない場合）。
.. フックとループストラップを使用して、ケーブルをケーブルマネジメントデバイスにバインドします。


. 2台目のコントローラに対して<<step2_remove_controller_canister,手順 2 ：コントローラキャニスターを取り外す>>、、<<step3_upgrade_hic,手順 3 ： HIC をアップグレードする>>、を<<step4_reinstall_controller,手順 4 ：コントローラキャニスターを再度取り付ける>>繰り返します。




== 手順 5 ： HIC のアップグレードを完了します

両方のコントローラをオンラインにし、サポートデータを収集して、処理を再開します。

.手順
. コントローラをオンラインにします。
+
.. 電源ケーブルを接続します。


. コントローラのブート時に、コントローラのLEDを確認します。
+
** 黄色の警告 LED が点灯した状態になります。
** ホストリンク LED は、ホストインターフェイスに応じて、点灯、点滅、消灯のいずれかになります。


. コントローラがオンラインに戻ったら、ステータスが「最適」になっていることを確認し、コントローラシェルフの警告LEDを確認します。
+
ステータスが「最適」でない場合やいずれかの警告LEDが点灯している場合は、すべてのケーブルが正しく装着され、コントローラキャニスターが正しく取り付けられていることを確認します。必要に応じて、コントローラキャニスターを取り外して再度取り付けます。

+

NOTE: 問題が解決しない場合は、テクニカルサポートにお問い合わせください。

. すべてのボリュームが優先所有者に戻っていることを確認します。
+
.. [ストレージ]>[ボリューム]*を選択します。[ * すべてのボリューム * ] ページで、ボリュームが優先所有者に配布されていることを確認します。ボリューム所有者を表示するには、[その他]>[所有権の変更]*を選択します。
.. すべてのボリュームが優先所有者に所有されている場合は、手順 6 に進みます。
.. いずれのボリュームも戻っていない場合は、手動でボリュームを戻す必要があります。詳細›ボリュームの再配置*に進みます。
.. 自動配信または手動配信のあとに一部のボリュームだけが優先所有者に戻った場合は、 Recovery Guru でホスト接続の問題を確認する必要があります。
.. Recovery Guru がない場合、または Recovery Guru の手順に従ってもボリュームが優先所有者に戻らない場合は、サポートに問い合わせてください。


. SANtricity システムマネージャを使用してストレージアレイのサポートデータを収集します。
+
.. [サポート]>[サポートセンター]>[診断]*を選択します。
.. 「サポートデータの収集」を選択します。
.. [*Collect*]( 収集 ) をクリックします
+
ブラウザの Downloads フォルダに、「 * support-data.7z * 」という名前でファイルが保存されます。





.次の手順
これでストレージアレイのホストインターフェイスカードをアップグレードする処理は完了です。通常の運用を再開することができます。
