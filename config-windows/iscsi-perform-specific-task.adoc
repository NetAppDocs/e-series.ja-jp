---
permalink: config-windows/iscsi-perform-specific-task.html 
sidebar: sidebar 
keywords: iSCSI, switches, IP network configuration, express Windows configuration, software configuration, Windows host, E2800, E5700, EF300, EF600, E-Series, eseries 
summary: iSCSI プロトコルを使用する場合は、スイッチを設定し、アレイ側とホスト側でネットワークを設定します。その後、 IP ネットワーク接続を確認します。 
---
= Eシリーズ- WindowsでのiSCSI固有のタスクの実行
:allow-uri-read: 
:experimental: 
:icons: font
:imagesdir: ../media/


[role="lead"]
iSCSI プロトコルを使用する場合は、スイッチを設定し、アレイ側とホスト側でネットワークを設定してから、 IP ネットワーク接続を確認します。



== 手順1：スイッチを設定します。iSCSI、Windows

iSCSI に関するベンダーの推奨事項に従ってスイッチを設定します。これらの推奨事項には、設定の指示とコードの更新が含まれる場合があります。

.作業を開始する前に
次のものがあることを確認します。

* 高可用性を実現するために、 2 つの独立したネットワークVLAN または 2 つの独立したネットワークを使用して、 iSCSI トラフィックを別々のネットワークセグメントに分離してください。
* 送受信ハードウェアフロー制御 * エンドツーエンド * を有効にしました。
* 優先度フロー制御が無効になりました。
* 必要に応じて、ジャンボフレームを有効にします。



NOTE: コントローラのスイッチポートでは、ポートチャネル / LACP がサポートされません。ホスト側 LACP は推奨されません。マルチパスを使用すると、同等以上のメリットが得られます。

.手順
スイッチベンダーのマニュアルを参照してください。



== 手順2：ネットワークを設定する-- iSCSI Windows

iSCSI ネットワークは、データストレージの要件に応じて、さまざまな方法でセットアップできます。環境に最適な構成を選択するには、ネットワーク管理者に相談してください。

iSCSI ネットワークに基本的な冗長性を効果的に設定するには、各ホストポートと各コントローラの 1 つのポートを別々のスイッチに接続し、ホストポートとコントローラポートの各セットを VLAN を使用して別々のネットワークセグメントに分離します。

.作業を開始する前に
次のものがあることを確認します。

* 送受信ハードウェアフロー制御 * エンドツーエンド * を有効にしました。
* 優先度フロー制御が無効になりました。
* 必要に応じて、ジャンボフレームを有効にします。
+
パフォーマンス上の理由から IP SAN 内でジャンボフレームを使用している場合は、アレイ、スイッチ、およびホストでジャンボフレームを使用するように設定してください。ホストおよびスイッチでジャンボフレームを有効にする方法については、使用するオペレーティングシステムとスイッチのドキュメントを参照してください。アレイでジャンボフレームを有効にするには、手順 3 の手順を実行します。



.手順
スイッチベンダーのマニュアルを参照してください。


NOTE: 多くのネットワークスイッチは 9 、 000 バイトを超える IP オーバーヘッドを設定する必要があります。詳細については、スイッチのマニュアルを参照してください。



== 手順3：アレイ側のネットワークを構成する-- iSCSI、Windows

SANtricity System Manager の GUI を使用して、アレイ側の iSCSI ネットワークを設定します。

.作業を開始する前に
* いずれかのストレージアレイコントローラの IP アドレスまたはドメイン名。
* System Manager GUI 、ロールベースアクセス制御（ RBAC ）、または LDAP のパスワード、およびストレージアレイへの適切なセキュリティアクセスのために設定されたディレクトリサービス。アクセス管理の詳細については、 SANtricity システムマネージャオンラインヘルプを参照してください。


.このタスクについて
このタスクでは、ハードウェアページから iSCSI ポート設定にアクセスする方法について説明します。設定には、 System （設定） > Configure iSCSI Ports （ iSCSI ポートの設定）メニューからもアクセスできます。

.手順
. ブラウザで、「 + https://<DomainNameOrIPAddress>+` 」という URL を入力します
+
「 IPAddress 」は、ストレージアレイコントローラの 1 つのアドレスです。

+
設定されていないアレイで初めて SANtricity システムマネージャを開くと、管理者パスワードの設定プロンプトが表示されます。ロールベースアクセス管理では、 admin 、 support 、 security 、 monitor の 4 つのローカルロールが設定されます。最後の 3 つのロールには、推測されにくいランダムなパスワードが設定されています。admin ロールのパスワードを設定したら、 admin クレデンシャルを使用してすべてのパスワードを変更できます。4 つのローカルユーザロールの詳細については、 SANtricity System Manager オンラインヘルプを参照してください。

. 管理者パスワードの設定フィールドとパスワードの確認フィールドに管理者ロールの System Manager パスワードを入力し、パスワードの設定 * ボタンを選択します。
+
プール、ボリュームグループ、ワークロード、または通知が設定されていない状態で System Manager を開くと、セットアップウィザードが起動します。

. セットアップウィザードを閉じます。
+
このウィザードは、あとで追加のセットアップタスクを実行する際に使用します。

. 「 * ハードウェア * 」を選択します。
. 図にドライブが表示されている場合は、 * シェルフの背面を表示 * をクリックします。
+
図の表示が切り替わり、ドライブではなくコントローラが表示されます。

. iSCSI ポートを設定するコントローラをクリックします。
+
コントローラのコンテキストメニューが表示されます。

. Configure iSCSI Port* （ iSCSI ポートの設定）を選択します。
+
Configure iSCSI Ports （ iSCSI ポートの設定）ダイアログボックスが開きます。

. ドロップダウンリストで、設定するポートを選択し、 * Next * をクリックします。
. 構成ポートの設定を選択し、 * 次へ * をクリックします。
+
すべてのポート設定を表示するには、ダイアログボックスの右側にある * Show more port settings * リンクをクリックします。

+
|===
| ポートの設定 | 説明 


 a| 
イーサネットポート速度の設定
 a| 
目的の速度を選択します。ドロップダウンリストに表示されるオプションは、ネットワークがサポートできる最大速度（ 10Gbps など）によって異なります。


NOTE: E5700 / EF570 コントローラのオプションの iSCSI ホストインターフェイスカードでは、速度が自動ネゴシエートされません。各ポートの速度を 10Gb または 25Gb に設定する必要があります。すべてのポートを同じ速度に設定する必要があります。



 a| 
IPv4 を有効にする / IPv6 を有効にする
 a| 
一方または両方のオプションを選択して、 IPv4 ネットワークと IPv6 ネットワークのサポートを有効にします。



 a| 
TCP リスニングポート（ [Show more port settings] をクリックすると使用可能）
 a| 
必要に応じて、新しいポート番号を入力します。リスニングポートは、コントローラがホスト iSCSI イニシエータからの iSCSI ログインをリスンするために使用する TCP ポート番号です。デフォルトのリスニングポートは 3260 です。3260 、または 49152~65535 の値を入力する必要があります。



 a| 
MTU サイズ（ * Show more port settings* をクリックすると使用可能）
 a| 
必要に応じて、 Maximum Transmission Unit （ MTU ；最大伝送ユニット）の新しいサイズをバイト単位で入力します。デフォルトの Maximum Transmission Unit （ MTU ；最大転送単位）サイズは 1500 バイト / フレームです。1500~9000 の値を入力する必要があります。



 a| 
ICMP PING 応答を有効にします
 a| 
Internet Control Message Protocol （ ICMP ）を有効にする場合は、このオプションを選択します。ネットワーク接続されたコンピュータのオペレーティングシステムは、このプロトコルを使用してメッセージを送信します。ICMP メッセージを送信することで、ホストに到達できるかどうかや、そのホストとのパケットの送受信にどれくらいの時間がかかるかが確認されます。

|===
+
[*IPv4 を有効にする *] を選択した場合は、 [ 次へ *] をクリックすると、 IPv4 設定を選択するためのダイアログボックスが開きます。[*IPv6 を有効にする *] を選択した場合、 [ 次へ *] をクリックすると、 IPv6 設定を選択するためのダイアログボックスが開きます。両方のオプションを選択した場合は、 IPv4 設定のダイアログボックスが最初に開き、 * 次へ * をクリックすると、 IPv6 設定のダイアログボックスが開きます。

. IPv4 と IPv6 、またはその両方を自動または手動で設定します。すべてのポート設定を表示するには、ダイアログボックスの右側にある * Show more settings * リンクをクリックします。
+
|===
| ポートの設定 | 説明 


 a| 
自動的に設定を取得します
 a| 
設定を自動的に取得するには、このオプションを選択します。



 a| 
静的な設定を手動で指定します
 a| 
このオプションを選択した場合は、フィールドに静的アドレスを入力します。IPv4 の場合は、ネットワークのサブネットマスクとゲートウェイも指定します。IPv6 の場合は、ルーティング可能な IP アドレスとルータの IP アドレスも指定します。



 a| 
VLAN サポートを有効にします（ * Show more settings * をクリックして使用可能）。
 a| 

NOTE: このオプションは、 iSCSI 環境でのみ使用できます。NVMe over RoCE 環境では使用できません。

VLAN を有効にしてその ID を入力する場合は、このオプションを選択します。VLAN は、同じスイッチ、同じルータ、またはその両方でサポートされる他の物理 LAN （ローカルエリアネットワーク）および仮想 LAN から物理的に分離されたように動作する論理ネットワークです。



 a| 
イーサネットの優先順位を有効にする（ [ 詳細設定を表示する *] をクリックして使用可能）。
 a| 

NOTE: このオプションは、 iSCSI 環境でのみ使用できます。NVMe over RoCE 環境では使用できません。

ネットワークアクセスの優先度を決定するパラメータを有効にする場合は、このオプションを選択します。スライダを使用して優先度を 1 から 7 の間で選択します。共有 LAN 環境（イーサネットなど）では、多数のステーションがネットワークアクセスで競合する可能性があります。アクセスは先に行われたものから順に処理されます。2 つのステーションが同時にネットワークにアクセスしようとすると、両方のステーションがオフになり、再試行するまで待機します。スイッチイーサネットでは、 1 つのステーションだけがスイッチポートに接続されるため、このプロセスは最小限に抑えられます。

|===
. [ 完了 ] をクリックします。
. System Manager を終了します。




== 手順4：ホスト側のネットワークを設定する- iSCSI

Microsoft iSCSI イニシエータがアレイとのセッションを確立できるように、ホスト側で iSCSI ネットワークを設定する必要があります。

.作業を開始する前に
次のものがあることを確認します。

* iSCSI ストレージトラフィックの伝送に使用される、完全に構成されたスイッチ。
* 送受信ハードウェアフロー制御 * エンドツーエンド * を有効にしました
* 優先度フロー制御が無効になりました。
* アレイ側の iSCSI 設定が完了しました。
* コントローラの各ポートの IP アドレス。


.このタスクについて
この手順では、 2 つの NIC ポートが iSCSI トラフィックに使用されることを想定しています。

.手順
. 使用していないネットワークアダプタプロトコルを無効にします
+
これらのプロトコルには、 QoS 、ファイルとプリンタの共有、 NetBIOS などがありますが、これらに限定されません。

. ホストのターミナル・ウィンドウから 'iscsicpl.exe を実行して '* iSCSI Initiator Properties* ダイアログ・ボックスを開きます
. [** 検出 **] タブで、 [* ポータルの検出 *] を選択し、 iSCSI ターゲットポートの 1 つの IP アドレスを入力します。
. [** ターゲット **] タブで、検出した最初のターゲットポータルを選択し、 [* 接続 ] を選択します。
. [ マルチパスを有効にする *] を選択し、 [ この接続をお気に入りターゲットのリストに追加する *] を選択して、 [** 詳細 ** を選択します。
. ローカルアダプター * の場合は、 * Microsoft iSCSI イニシエータ * を選択します。
. * Initiator IP * には、 iSCSI ターゲットの 1 つと同じサブネットまたは VLAN 上のポートの IP アドレスを選択します。
. * Target IP * には、上記の手順で選択した * Initiator IP * と同じサブネット上のポートの IP アドレスを選択します。
. 残りのチェックボックスはデフォルト値のままにして、 * OK * を選択します。
. [ ターゲットへの接続 * ] ダイアログボックスに戻ったら、再度「 * OK * 」を選択します。
. ストレージアレイへの接続を確立する各イニシエータポートとセッション（論理パス）に対して、この手順を繰り返します。




== 手順5：IPネットワーク接続の確認-- iSCSI、Windows

インターネットプロトコル（ IP ）ネットワーク接続を確認するには、 ping テストを使用してホストとアレイが通信できることを確認します。

. [ スタート ]>[ すべてのプログラム ]>[ アクセサリ ]>[ コマンドプロンプト ] の順に選択し、ジャンボフレームが有効になっているかどうかに応じて、 Windows CLI を使用して次のいずれかのコマンドを実行します。
+
** ジャンボフレームが有効になっていない場合は、次のコマンドを実行します。
+
[listing]
----
ping -S <hostIP\> <targetIP\>
----
** ジャンボフレームが有効な場合は、ペイロードサイズに 8 、 972 バイトを指定して ping コマンドを実行します。IP と ICMP を組み合わせたヘッダーは 28 バイトで、これがペイロードに追加されて 9 、 000 バイトになります。f オプションを指定すると、「 do non fragment (DF) 」ビットが設定されます。l オプションを使用してサイズを設定できます。これらのオプションにより、 iSCSI イニシエータとターゲットの間で 9 、 000 バイトのジャンボフレームを正常に送信できます。
+
[listing]
----
ping -l 8972 -f <iSCSI_target_IP_address\>
----
+
この例では、 iSCSI ターゲットの IP アドレスは「 192.0.2.8 」です。

+
[listing]
----
C:\>ping -l 8972 -f 192.0.2.8
Pinging 192.0.2.8 with 8972 bytes of data:
Reply from 192.0.2.8: bytes=8972 time=2ms TTL=64
Reply from 192.0.2.8: bytes=8972 time=2ms TTL=64
Reply from 192.0.2.8: bytes=8972 time=2ms TTL=64
Reply from 192.0.2.8: bytes=8972 time=2ms TTL=64
Ping statistics for 192.0.2.8:
  Packets: Sent = 4, Received = 4, Lost = 0 (0% loss),
Approximate round trip times in milli-seconds:
  Minimum = 2ms, Maximum = 2ms, Average = 2ms
----


. 各ホストのイニシエータ・アドレス（ iSCSI に使用されるホスト・イーサネット・ポートの IP アドレス）から各コントローラの iSCSI ポートへの ping コマンド問題構成内の各ホストサーバから、必要に応じて IP アドレスを変更してこの操作を実行します。
+

NOTE: コマンドが失敗した場合（たとえば、「 Packet needs to be fragmented but DF set 」が返された場合）は、ホストサーバ、ストレージコントローラ、およびスイッチポートのイーサネットインターフェイスの MTU サイズ（ジャンボフレームのサポート状況）を確認します。





== 手順 6 ：設定を記録します

このページの PDF を生成して印刷し、次のワークシートを使用して iSCSI ストレージの構成情報を記録できます。この情報は、プロビジョニングタスクを実行する際に必要になります。



=== 推奨される構成

推奨構成は、 2 つのイニシエータポートと 4 つのターゲットポートを 1 つ以上の VLAN で接続した構成です。

image::../media/50001_01_conf-win.gif[iSCSIポート識別子]



=== ターゲット IQN

|===
| 番号 | ターゲットポート接続 | IQN 


 a| 
2.
 a| 
ターゲットポート
 a| 

|===


=== マッピングホスト名

|===
| 番号 | ホスト情報 | 名前とタイプ 


 a| 
1.
 a| 
マッピングホスト名
 a| 



 a| 
 a| 
ホスト OS タイプ
 a| 

|===